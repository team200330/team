<?xml version="1.0" encoding="UTF-8"?>

<!DOCTYPE mapper
	PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" 
		   "http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="com.team.mapper.ChatMapper">
	
	<select id="selectMessage" resultType="Message">
		select message, send_date
		from message
		order by message_no asc
	</select>

	<insert id="createChat" parameterType="Chat">
		INSERT INTO chat ( chat_no, chat_name )
		VALUES ( #{ chatNo }, #{ chatName })
	</insert>
	
	<insert id="insertMessage" parameterType="Message">
		insert into message message
		values #{ message }
	</insert>
	
	
	<resultMap type="Chat" id="chatMap">
		<id column="chat_no" property="chatNo"/>
		<result column="chat_name" property="chatName"/>
		<collection property="messages" column="chat_no" resultMap="chatmemberMap" />
		<collection property="members" column="chat_no" resultMap="messageMap" />
	</resultMap>
	<resultMap type="ChatMember" id="chatmemberMap">
		<id column="chat_no" property="chatNo"/>
		<result column="email" property="email"/>
	</resultMap>
	<resultMap type="message" id="messageMap">
		<id column="message_no" property="messageNo"/>
		<result column="message" property="message"/>
		<result column="send_date" property="sendDate"/>
	</resultMap>

</mapper>