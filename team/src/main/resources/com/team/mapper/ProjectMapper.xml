<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="com.team.mapper.ProjectMapper">
	
	<resultMap type="project" id="projectMap">
		<id column="project_no" property="projectNo" />
		<result column="workspace_no" property="workspaceNo" />
		<result column="project_name" property="projectName" />
		<result column="startdate" property="startdate" />
		<result column="content" property="content" />
		<result column="manager_email" property="managerEmail" />
		<result column="deleted" property="deleted" />
		<result column="pro_public" property="proPublic" />
		<result column="template_no" property="templateNo" />
		<result column="pro_no" property="proNo" />
	</resultMap>
	
	<resultMap type="ProjectMember" id="projectMemberMap">
		<result column="project_no" property="projectNo"/>
		<result column="email" property="email"/>
	</resultMap>
	
	<resultMap type="WorkspaceMember" id="workspaceMemberMap">
		<id column="workspace_no" property="workspaceNo" />
		<result column="email" property="email" />
		<result column="type_no" property="typeNo" />
	</resultMap> 
	
	<insert id="insertProject">
		INSERT INTO project ( project_name, content, manager_email, pro_public, template_no, workspace_no)
		VALUES ( #{projectName}, #{content}, "1@1", #{proPublic}, #{templateNo}, "6" )
	</insert>
	
	<select id="selectProject" resultMap="projectMap">
		<![CDATA[ SELECT * FROM project WHERE deleted = 0 AND workspace_no = 6 ORDER BY project_no DESC; ]]>
		
		<!-- <![CDATA[ SELECT * FROM project WHERE deleted = 0 AND workspace_no = #{workspace_no} ORDER BY project_no DESC; ]]> -->
	</select>
	
	<select id="selectProject2" resultMap="projectMap">
		<![CDATA[ SELECT * FROM project WHERE deleted = 0 AND workspace_no = 6 ORDER BY project_no DESC LIMIT 4 ]]>
		<!--  <![CDATA[ SELECT * FROM project WHERE deleted = 0 AND workspace_no = #{workspace_no} ORDER BY project_no DESC LIMIT 4 ]]> -->
	</select>
	
	<select id="selectProjectByWorkspaceNo" parameterType="int" resultMap="projectMap">
		SELECT * FROM project
		WHERE workspace_no = #{ workspaceNo } 
	</select>
	
	<update id="updateProjectNo" parameterType="hashmap">
		UPDATE project SET pro_no=#{ proNo } 
		WHERE project_no = #{ projectNo }
	</update>
	
	<update id="updateProject">
		UPDATE project SET project_name = #{ projectName }, content = #{ content }, pro_public = #{ proPublic }, startdate = #{startdate}, deadline = #{deadline}, enddate = #{enddate}
		WHERE project_no = #{ projectNo }
	</update>
	
	<select id="selectProjectByNo" parameterType="int" resultMap="projectMap">
		SELECT * FROM project
		WHERE project_no = #{ projectNo }
	</select>
	
	<select id="selectPageing" parameterType="hashmap" resultMap="projectMap">

	</select>
	
	<select id="selectProjectListCount" parameterType="hashmap" resultType="int" >
		SELECT COUNT(*) FROM project WHERE deleted = '0' ORDER BY project_no DESC
	</select>
	
	<select id="selectDetail" parameterType="int" resultMap="projectMap">
		SELECT * FROM project
		WHERE project_no = #{projectNo}	
	</select>
	
	
	
	<select id="selectMemberByProjectNo" parameterType="int" resultMap="projectMemberMap">
		SELECT * FROM project_member
		WHERE project_no = #{ projectNo }
	</select>


</mapper>





